---
description: "Defines fixed data models & validation helpers."
globs:
  - "src/core/**/*.py"
---

You are writing code that ingests the three fixed-schema workbooks.  
Enforce the following constants in **every** parser:
```python
COLUMNS_17_FIXED_SCHEMA = [
    "JournalID", "TxnID", "TxnDate", "CashDate",
    "DCFlag", "GAAPAccount", "CashFlowSection",
    "Department", "Product", "CustomerID", "VendorID",
    "Location", "Class", "Amount", "CurrencyCode",
    "CreatedAt", "UpdatedAt",
]

MANDATORY_CURRENCY = "USD"

Validation checklist (raise MappingConflict or SchemaError):

Check	Rule
Column presence	 Every fixed file must include all schema columns (order irrelevant).
DCFlag	Must be 'D' or 'C' – case sensitive.
Amount	Decimal(18,2) and positive; sign is inferred from DCFlag & account type.
GAAP Mapping	Every GAAPAccount appearing in the journal must exist in GAAP Mapping.xlsx.
Cash-Flow Mapping	Unknown buckets → error unless bucket is "Unscheduled Cash".

Return errors via core.errors.report() which must emit:
```json
{
  "file": "GAAP Mapping.xlsx",
  "row": 42,
  "issue": "GAAPAccount 5100 missing in mapping",
  "hint": "Add 5100-COGS to mapping or correct the AP grid reference."
}